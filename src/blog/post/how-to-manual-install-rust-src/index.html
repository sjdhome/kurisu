<!DOCTYPE html>
<html lang="zh-Hans">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="解决Visual Studio Code中rust-analyzer报错。" />
  <title>如何手动安装rust-src - sjdhome blog</title>
  <link rel="stylesheet" href="/css/flex.css" />
  <link rel="stylesheet" href="/css/limit-content-width.css" />
  <link rel="stylesheet" href="/css/font.css" />
  <link rel="stylesheet" href="/css/global.css" />
  <link rel="stylesheet" href="/blog/css/block.css" />
  <link rel="stylesheet" href="/blog/css/title-block.css" />
  <link rel="stylesheet" href="/css/body.css" />
  <link rel="stylesheet" href="/css/copyright.css" />
  <link rel="stylesheet" href="/css/code.css" />
  <link rel="stylesheet" href="/css/better-hr.css" />
  <link rel="stylesheet" href="/blog/css/post.css" />
  <link rel="stylesheet" href="/css/margin.css" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
</head>

<body>
  <header>
    <div class="flex flex-vertical limit-content-width title-block">
      <div class="flex align-items-center margin-lr-1dot5">
        <a href="/blog/">
          <picture>
            <source srcset="/img/earth.webp">
            <source srcset="/img/earth.jpg">
            <img src="/img/earth.jpg" alt="avatar" width="64" height="64" class="round" />
          </picture>
        </a>
        <a href="/blog/" class="title-text no-a-decoration">sjdhome blog</a>
      </div>
      <div class="subtitle margin-lr-1dot5">
        <small>A blog about web development and other things.</small>
      </div>
    </div>
  </header>
  <hr />
  <main class="limit-content-width flex">
    <div class="only-block-style">
      <h1 class="post-title">如何手动安装rust-src</h1>
      <small>2023年5月30日</small>
      <p>
        安装Rust，官方通常推荐使用rustup进行安装和版本管理。可如果我<strong>就是不听</strong>，一定要手动安装，官方也提供了Standalone
        installers。可是用这种方式安装的Rust不带rust-src，使用Visual
        Studio Code时rust-analyzer扩展会出现如下的错误提示：</p>
      <p><img src="../../img/rust-src-error.png" alt="Failed to spawn one or more proc-macro servers." width="531"
          height="323" /></p>
      <p>最后一句<em>try installing the Rust source the same way you installed
          rustc</em>是解决问题的关键。对于如何修复这个错误，Google并不能找出直接的答案。大多数解答都是针对rustup安装错误，安装rust-src的方法也只有使用rustup。</p>
      <h2>解决方法</h2>
      <p>在<a href="https://forge.rust-lang.org/infra/other-installation-methods.html#source-code">Standalone
          installers下载页面的底部</a>，可以下载对应当前版本的rust-src的压缩包。之后需要在<code><em>Rust安装位置</em>/lib/rustlib/</code>下创建一个<code>src</code>文件夹，然后将压缩包里的<code>rust-<em>版本号</em>-src</code>文件夹解压到<code>src</code>目录下，并将<code>rust-<em>版本号</em>-src</code>重命名为<code>rust</code>。
      </p>
      <p><img src="../../img/rust-src-result.png" alt="Rust\lib\rustlib\src\rust" width="707" height="509" /></p>
    </div>
  </main>
  <footer>
    <div class="copyright">sjdhome &copy; 2023</div>
  </footer>
</body>

</html>